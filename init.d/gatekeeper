#!/bin/sh /etc/rc.common
# Gatekeeper LLM service for nighttime internet access control
# Location: /etc/init.d/gatekeeper

START=99
STOP=10

USE_PROCD=1
PROG=/root/gatekeeper.py

start_service() {
    logger -t gatekeeper "Starting gatekeeper service"

    procd_open_instance
    procd_set_param command /usr/bin/python3 "$PROG" --server
    procd_set_param respawn ${respawn_threshold:-3600} ${respawn_timeout:-5} ${respawn_retry:-5}
    procd_set_param stdout 1
    procd_set_param stderr 1
    procd_set_param pidfile /var/run/gatekeeper.pid
    procd_close_instance
}

stop_service() {
    logger -t gatekeeper "Stopping gatekeeper service"
}

reload_service() {
    stop
    start
}
